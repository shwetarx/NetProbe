{% extends "base.html" %}
{% block title %}SSL Certificate Inspector{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto mt-10 bg-gray-900 p-6 rounded-xl shadow-xl">
    <h2 class="text-2xl text-white font-semibold mb-4">SSL Certificate Inspector</h2>
    <form id="sslForm" class="space-y-4">
        <input
            type="text"
            id="domain"
            name="domain"
            placeholder="Enter a domain (e.g. example.com)"
            class="w-full p-3 rounded bg-gray-800 text-white placeholder-gray-500"
            required
        />
        <button
            type="submit"
            class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded transition duration-200"
        >
            Inspect SSL
        </button>
    </form>
    <div id="output" class="mt-6 bg-gray-800 p-4 rounded text-sm text-white whitespace-pre-line"></div>
</div>

<script>
    document.getElementById("sslForm").addEventListener("submit", async function (e) {
        e.preventDefault();
        const domain = document.getElementById("domain").value.trim();
        const output = document.getElementById("output");
        output.innerHTML = "";

        try {
            const res = await fetch("/ssl", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ domain })
            });

            const data = await res.json();

            if (data.error) {
                output.innerHTML = `<span class="text-red-400">${data.error}</span>`;
            } else {
                let html = "";
                for (let key in data) {
                    if (data[key]) {
                        html += `<div><strong>${key}:</strong> ${data[key]}</div>`;
                    }
                }
                output.innerHTML = html || "<em>No certificate data found.</em>";
            }
        } catch (err) {
            output.innerHTML = `<span class="text-red-400">Error: ${err}</span>`;
        }
    });
</script>
{% endblock %}
